{% block body %}

    [
    {% for formation in formations %}

      {
      "id" : "{{formation.formationId}}",
      "name" : "{{formation.nom|e('js')}}",
      "type" : "Formation",
      "url" : "{{formation.url}}",
      "annee" : "{{formation.annee}}",
      "niveau" : "{{formation.niveau}}",
      "typediplome" : "{{formation.typediplome}}",
      "effectif" : "{{formation.effectif}}",
      "etablissement" :
        "{% for etabl in formation.etablissement %}{{etabl.nom|e('js')}}{% if loop.last %}{% else %},{% endif %}{% endfor %}",
      "discipline" : [
        {% for discipline in formation.discipline %}
          "{{discipline.nom|e('js')}}"{% if loop.last %}{% else %},{% endif %}
        {% endfor %}
      ],
      "hesamette" : [
          
        {% for discipline in formation.discipline %}
        {% set item = 0 %}
        {% if discipline.type != "NW3" %} {# suppression des NW3 qui n'ont pas d'hesamette #}
          "{{discipline.hesamette|e('js')}}"
          {% set item = item + 1 %}
          {% if loop.length == item %}{% elseif loop.index >= (loop.length - item) %}{% else %},{% endif %}
        {% endif %}
        {% endfor %}
      ]
      },
    {% endfor %}
    {% for labo in labos %}
      {
      "id" : "{{labo.laboId}}",
      "name" : "{{labo.nom|e('js')}}",
      "type" : "Laboratoire",
      "url" : "{{labo.lien}}",
      "mailcontact" : "{{labo.mailcontact}}",
      "sigle" : "{{labo.sigle}}",
      "code" : "{{labo.code}}",
      "ctype" : "{{labo.type}}",
      "etablissement" : "{% for etabl in labo.etablissement %}{{etabl.nom|e('js')}}{% if loop.last %}{% else %},{% endif %}{% endfor %}",
      "discipline" : [
        {% for discipline in labo.discipline %}
          "{{discipline.nom|e('js')}}"{% if loop.last %}{% else %},{% endif %}
        {% endfor %}
      ],
      "equipement" : [
        {% for equipement in labo.equipement %}
          "{{equipement.nom|e('js')}}"{% if loop.last %}{% else %},{% endif %}
        {% endfor %}
      ],
      "hesamette" : [
        {% for discipline in labo.discipline %}
        {% set item = 0 %}
        {% if discipline.type != "NW3" %} {# suppression des NW3 qui n'ont pas d'hesamette #}
          "{{discipline.hesamette|e('js')}}"
          {% set item = item + 1 %}
          {% if loop.length == item %}{% elseif loop.index >= (loop.length - item) %}{% else %},{% endif %}
        {% endif %}
        {% endfor %}
        
      ]
    },
    {% endfor %}
    ]




{% endblock %}